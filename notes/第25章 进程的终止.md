# 第25章 进程的终止

## 25.1进程的终止

通常,进程有两种终止方式。

其一为异常(abnormal)终止,由对一信号的接收而引发,该信号的默认动作为终止当前进程,可能产生核心转储(core dump) 。

此外,进程可使用\_exit()系统调用正常(normally)终止。

```c
#include <unistd.h>
void _exit(status);
```

\_exit()的 status 参数定义了进程的终止状态(termination status),父进程可调用 wait()
以获取该状态。虽然将其定义为 int 类型,但仅有低 8 位可为父进程所用。
调用\_exit()的程序总会成功终止(即,\_exit()从不返回)。



程序一般不会直接调用\_exit(),而是调用库函数 exit(),它会在调用_exit()前执行各种动作。 

```c
#include <stdlib.h>
void exit(int status);
```

exit()会执行的动作如下。

- 调用退出处理程序(通过 atexit()和 on_exit()注册的函数),其执行顺序与注册顺序相反(见 25.3 节)。
-  刷新 stdio 流缓冲区。
-  使用由 status 提供的值执行_exit()系统调用。



程序的另一种终止方法是从 main()函数中返回(return),执行 return n 等同于执行对 exit(n)的调用,因为调用 main()的运行时函数会将 main()的返回值作为 exit()的参数。



## 25.2 进程终止的细节

无论进程是否正常终止，都会发生以下的动作：

- 释放资源，如文件描述符、目录流
- 如果该进程是一个管理终端的进程，将会向终端前台的进程组中的每个进程发送 SIGHUP 信号，并脱离与终端的会话。



## 25.3 退出处理程序

   





